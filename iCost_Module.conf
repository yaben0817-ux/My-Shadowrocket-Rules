#!name=iCost AI 服务监控 (Pro)
#!desc=监控主流AI模型(DeepSeek, SiliconFlow, Google, OpenAI等)的API请求耗时、Token消耗(In/Out)及图片识别数量。
#!author=yaben0817-ux
#!homepage=https://github.com/yaben0817-ux/My-Shadowrocket-Rules
#!icon=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Bot.png

[MITM]
hostname = %APPEND% api.deepseek.com, api.siliconflow.cn, ark.cn-beijing.volces.com, openrouter.ai, api.moonshot.cn, generativelanguage.googleapis.com, api.openai.com, api.anthropic.com

[Script]
# ---------------------------------------------------
# 核心修改点：将脚本路径指向你自己的 GitHub 链接
# 并添加 ?v=final 确保强制更新
# ---------------------------------------------------

# 1. 请求阶段 (Request)：用于记录开始时间、统计上传图片数量
iCost_Request_Monitor = type=http-request, pattern=^https?://(api\.deepseek\.com/chat/completions|api\.siliconflow\.cn/v1/chat/completions|ark\.cn-beijing\.volces\.com/api/v3/chat/completions|openrouter\.ai/api/v1/chat/completions|api\.moonshot\.cn/v1/chat/completions|generativelanguage\.googleapis\.com/v1beta/openai/chat/completions|api\.openai\.com/v1/chat/completions|api\.anthropic\.com/v1/messages), requires-body=true, max-size=3145728, script-path=https://raw.githubusercontent.com/yaben0817-ux/My-Shadowrocket-Rules/main/iCost_Stats.js?v=3sec, timeout=60

# 2. 响应阶段 (Response)：用于计算耗时、解析Token、发送通知
iCost_Response_Monitor = type=http-response, pattern=^https?://(api\.deepseek\.com/chat/completions|api\.siliconflow\.cn/v1/chat/completions|ark\.cn-beijing\.volces\.com/api/v3/chat/completions|openrouter\.ai/api/v1/chat/completions|api\.moonshot\.cn/v1/chat/completions|generativelanguage\.googleapis\.com/v1beta/openai/chat/completions|api\.openai\.com/v1/chat/completions|api\.anthropic\.com/v1/messages), requires-body=true, max-size=3145728, script-path=https://raw.githubusercontent.com/yaben0817-ux/My-Shadowrocket-Rules/main/iCost_Stats.js?v=3sec, timeout=60
