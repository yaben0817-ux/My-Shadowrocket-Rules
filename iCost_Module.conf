#!name=iCost AI 监控 (Pro)
#!desc=显示AI请求耗时(s)、Token消耗(In/Out)及历史统计。
#!author=yaben0817-ux
#!homepage=https://github.com/yaben0817-ux/My-Shadowrocket-Rules
#!icon=https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Bot.png

[Script]
# ✅ 修正点：必须同时配置 Request (请求) 和 Response (响应)
# 1. 请求阶段：记录开始时间
iCost_Monitor_Req = type=http-request, pattern=^https?://(api\.deepseek\.com|api\.siliconflow\.cn|ark\.cn-beijing\.volces\.com|openrouter\.ai|api\.moonshot\.cn|generativelanguage\.googleapis\.com|api\.openai\.com|api\.anthropic\.com)/.*, requires-body=true, script-path=https://raw.githubusercontent.com/yaben0817-ux/My-Shadowrocket-Rules/main/iCost_Stats.js, timeout=60

# 2. 响应阶段：计算耗时并通知
iCost_Monitor_Res = type=http-response, pattern=^https?://(api\.deepseek\.com|api\.siliconflow\.cn|ark\.cn-beijing\.volces\.com|openrouter\.ai|api\.moonshot\.cn|generativelanguage\.googleapis\.com|api\.openai\.com|api\.anthropic\.com)/.*, requires-body=true, max-size=3145728, script-path=https://raw.githubusercontent.com/yaben0817-ux/My-Shadowrocket-Rules/main/iCost_Stats.js, timeout=60

[MITM]
hostname = api.deepseek.com, api.siliconflow.cn, ark.cn-beijing.volces.com, openrouter.ai, api.moonshot.cn, generativelanguage.googleapis.com, api.openai.com, api.anthropic.com
